{% extends 'base.html' %}
{% block content %}
  <style>
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgba(0, 0, 0, 0.5);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    .modal-content {
      background-color: white;
      padding: 2rem;
      border-radius: 0.5rem;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      position: relative;
      width: 90%;
      max-width: 500px;
    }
    .modal-close {
      position: absolute;
      top: 0.5rem;
      right: 0.5rem;
      border: none;
      background: none;
      font-size: 1.5rem;
      cursor: pointer;
    }
    .create-unit-btn {
        padding: 10px 15px;
        border-radius: 5px;
        background-color: #708993;
        color: white;
        border: none;
        cursor: pointer;
        font-size: 1em;
    }
    .create-unit-btn:hover {
        background-color: #5682B1;
    }
    .modal-content form {
        display: flex;
        flex-direction: column;
        gap: 1rem;
    }
  </style>

  <div x-data="{ open: false }">
    <section>
      <button @click="open = true" class="create-unit-btn">Create New Unit</button>
    </section>

    <!-- Modal -->
    <div x-show="open" style="display: none; color: black;" x-transition @keydown.escape.window="open = false" class="modal-overlay">
      <div class="modal-content" @click.outside="open = false">
        <button @click="open = false" class="modal-close">&times;</button>
        <h2>Create Unit</h2>
        <form action="/upload" method="post" enctype="multipart/form-data">
          <label>Unit name (optional): <input type="text" name="unit" placeholder="e.g. algebra"></label>
          <label>Choose file: <input type="file" name="file" required></label>
          <button type="submit">Upload & Generate</button>
        </form>
      </div>
    </div>
  </div>

  <section>
    <h2>Units</h2>
    {% if units %}
      <ul>
        {% for u in units %}
          <li><a href="{{ url_for('unit_view', unit=u) }}">{{ u }}</a> â€” <a href="{{ url_for('download', unit=u) }}">download Json</a></li>
        {% endfor %}
      </ul>
    {% else %}
      <p>No units yet. Upload a file to create one.</p>
    {% endif %}
  </section>
{% endblock %}
